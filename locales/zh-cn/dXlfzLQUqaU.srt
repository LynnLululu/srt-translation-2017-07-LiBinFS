1
00:00:00,000 --> 00:00:01,540
（画外音）我们来探索

2
00:00:01,540 --> 00:00:03,209
控制台的另一个部分

3
00:00:03,209 --> 00:00:05,759
目前为止 你发送的所有消息
messages that you've sent

4
00:00:05,759 --> 00:00:08,669
have been sent to everybody 都发送到了使用该应用的每一个人
that's using the app.

5
00:00:08,669 --> 00:00:11,282
That's because we used 这是因为我们使用了这个“用户组”(user segment)目标 
this user segment target.

6
00:00:11,282 --> 00:00:12,990
But what if I want to 但是如果我想将通知发送到
send a notification

7
00:00:12,990 --> 00:00:15,080
to a specific user? 一名特定用户呢？

8
00:00:15,080 --> 00:00:17,820
In the console, I could 在控制台中 我可以选择“单个设备”(single device)
select single device.

9
00:00:17,820 --> 00:00:20,260
But now it's asking me for 但现在 它要我提供一个叫作 FCM 注册令牌
something called an FCM

10
00:00:20,260 --> 00:00:21,810
registration token.的东西

11
00:00:21,809 --> 00:00:24,329
An FCM registration    FCM 注册令牌是一个由数字和字符 
token is a string

12
00:00:24,329 --> 00:00:26,189
of numbers and 组成的字符串 用于
characters that is used

13
00:00:26,190 --> 00:00:29,040
to uniquely identify a device.唯一地标识设备

14
00:00:29,039 --> 00:00:31,710
It's generated when the app  它在应用首次启动时生成
first starts and changes,

15
00:00:31,710 --> 00:00:35,100
say, if you uninstall 并在你卸载和重装应用后更改
and reinstall the app.

16
00:00:35,100 --> 00:00:38,280
The FCM server can use these    FCM 服务器可以使用这些独特的令牌将消息
unique tokens to send messages

17
00:00:38,280 --> 00:00:40,480
to specific devices. 发送到特定设备

18
00:00:40,478 --> 00:00:42,179
So let's see how you 那么来看看你如何找到
actually find out

19
00:00:42,179 --> 00:00:45,707
what the FCM registration 自己设备的 FCM 注册令牌
token is for your device.

20
00:00:45,707 --> 00:00:47,789
There's actually pretty 实际上网上有比较清楚的
clear online documentation

21
00:00:47,789 --> 00:00:49,500
about how to do this.方法文档

22
00:00:49,500 --> 00:00:51,570
If I scroll down,我向下滚动 第一步是
the first step is

23
00:00:51,570 --> 00:00:55,020
to create a service that extends 创建一个扩展 FirebaseInstanceIDService
from Firebase instance ID

24
00:00:55,020 --> 00:00:56,790
service. 的服务

25
00:00:56,789 --> 00:00:58,710
Like all Android 像所有 Android 组件一样 该服务
components, the service

26
00:00:58,710 --> 00:01:01,079
needs to be registered 需要注册到清单文件
to the manifest.

27
00:01:01,079 --> 00:01:03,808
Now, to be able to catch the 现在 要在为你的设备生成令牌时
event when a token is generated

28
00:01:03,810 --> 00:01:05,549
for your device, it's 捕获事件 你需要
important that you

29
00:01:05,549 --> 00:01:07,009
have this intent filter here.在此添加 intent 过滤器

30
00:01:07,010 --> 00:01:10,950
它具有操作 Instance_ID_Event

31
00:01:10,950 --> 00:01:13,950
And after extending this service 在扩展此服务并将它添加到清单文件后
and adding it to the manifest,

32
00:01:13,950 --> 00:01:16,230
the only other real 另一件你真正需要做的事
thing that you need to do

33
00:01:16,230 --> 00:01:19,100
is implement this on 是实现此 onTokenRefresh 方法
token refresh method.

34
00:01:19,099 --> 00:01:21,629
And this method is part of the 而此方法是 FirebaseInstanceIDService 的
Firebase instance ID service

35
00:01:21,629 --> 00:01:22,158
class.一部分

36
00:01:22,159 --> 00:01:24,450
Functionally, you could do 从功能方面来说 在调用此方法时 你可以
a couple of different things

37
00:01:24,450 --> 00:01:25,996
when this method is called.执行多个不同的操作

38
00:01:25,995 --> 00:01:28,243
But for you, you just want 但是对于你 则只需知道这个令牌的内容
to know what that token is,

39
00:01:28,245 --> 00:01:31,109
so you can actually 以便在日志中将它实际打印出来
print it out in a log.

40
00:01:31,108 --> 00:01:33,628
For my Firebase instance 对于我的 FirebaseInstanceIDService 类
ID service class,

41
00:01:33,629 --> 00:01:36,959
I made a new folder called 我创建了一个叫作 FCM 的新文件夹并将它保存在了里面
FCM and saved it there.

42
00:01:36,959 --> 00:01:41,489
In this class, I simply have an 在这个类中 我有一个 onTokenRefresh 方法
on token refresh method, which

43
00:01:41,489 --> 00:01:43,489
then prints out the token. 它会将令牌打印出来

44
00:01:43,489 --> 00:01:45,478
I then also have a 还有一个无用的 sendRegistrationToSever
useless send registration

45
00:01:45,480 --> 00:01:48,450
to server method, which 方法 在此课程中我不会
I won't be doing anything

46
00:01:48,450 --> 00:01:49,810
with in this lesson.用到它

47
00:01:49,810 --> 00:01:53,070
But you can read the comments to 但你可以阅读注释 了解它的用处
see what it would be used for.

48
00:01:53,069 --> 00:01:55,439
I'm going to go 接下来我要运行我的应用
ahead and run my app.

49
00:01:55,438 --> 00:01:57,449
And then here in the 然后在这里的日志中 可以看到
logs, I can see that I've

50
00:01:57,450 --> 00:02:00,450
generated an instance ID token. 产生了一个实例 ID 令牌

51
00:02:00,450 --> 00:02:03,450
OK, so I'm going 那么我复制此令牌
to copy this token.

52
00:02:03,450 --> 00:02:07,219
And then I'm going to paste 并将它粘贴在控制台中的这个位置
it here in the console.

53
00:02:07,218 --> 00:02:10,710
I'll enter some 我要输入一些消息文本 然后
message text, and I'll

54
00:02:10,710 --> 00:02:13,290
go ahead and send the message. 发送消息

55
00:02:13,288 --> 00:02:16,750
And we can see that I 可以看到我收到了这条消息
just got this message.

56
00:02:16,750 --> 00:02:18,628
OK, now you can 好的 现在你可以自己操作了
do this yourself.

57
00:02:18,628 --> 00:02:22,348
Go ahead and generate the unique 使用 FirebaseInstanceIDService
token for your device using

58
00:02:22,348 --> 00:02:24,948
a Firebase instance 为你的设备生成唯一的令牌
ID service class.

59
00:02:24,949 --> 00:02:26,799
Print that token 在日志中打印出此令牌
out to the logs,

60
00:02:26,800 --> 00:02:30,790
and then use it to send an FCM 然后使用它向你自己的设备发送 FCM 消息
message just to your device.

61
00:02:30,788 --> 00:02:33,238
When you're done, enter 完成后 作为下一个小测试的一部分 
the FCM registration token

62
00:02:33,240 --> 00:02:35,409
as part of the next quiz. 输入此 FCM 注册令牌

